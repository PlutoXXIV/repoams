# M-Explore Parameters Configuration
#
# This file configures the autonomous exploration behavior using the m-explore package.
# M-Explore (explore_lite) automatically identifies unexplored areas (frontiers) and
# navigates to them to systematically map the entire environment.
#
# HOW M-EXPLORE WORKS:
# 1. Analyzes the occupancy grid map for "frontiers" (boundaries between known and unknown)
# 2. Evaluates each frontier based on:
#    - Information gain (how much new area will be revealed)
#    - Travel cost (distance to reach it)
#    - Potential field (avoid getting stuck in corners)
# 3. Sends navigation goals to NAV2 to reach the best frontier
# 4. Repeats until no more frontiers exist (exploration complete)
#
# Save this file as: ~/maze_robot_ws/src/maze_explorer/config/explorer_params.yaml

explore_node:
  ros__parameters:
    
    # =====================================================================
    # COORDINATE FRAMES
    # =====================================================================
    # Must match the frames defined in URDF and other config files
    
    # Robot's base frame (where robot is positioned)
    robot_base_frame: "base_footprint"
    
    # Global map frame (world coordinates)
    global_frame: "map"
    
    # =====================================================================
    # COSTMAP CONFIGURATION
    # =====================================================================
    # M-Explore uses the local costmap to identify frontiers and plan paths
    
    # Costmap topic (published by NAV2)
    costmap_topic: "/local_costmap/costmap"
    
    # Costmap updates topic (incremental updates for efficiency)
    costmap_updates_topic: "/local_costmap/costmap_updates"
    
    # Use local costmap (true) or global costmap (false)
    # Local is better for exploration as it's centered on robot
    use_local_costmap: true
    
    # =====================================================================
    # EXPLORATION BEHAVIOR
    # =====================================================================
    
    # Planner frequency: How often to evaluate and select new frontiers (Hz)
    # Lower values save CPU but may miss opportunities
    # Higher values are more responsive but use more resources
    planner_frequency: 0.5  # Re-plan every 2 seconds
    
    # Progress timeout: If no progress made in this time, consider exploration stuck (seconds)
    # Triggers re-planning or completion detection
    progress_timeout: 30.0
    
    # Visualize frontiers in RViz (true/false)
    # Shows candidate exploration goals as markers
    visualize: true
    
    # =====================================================================
    # FRONTIER EVALUATION
    # =====================================================================
    # These parameters control how frontiers are scored and selected
    
    # Potential scale: Weight for potential field
    # Potential field pushes robot away from obstacles and toward open space
    # Higher = prefer safer, more open areas
    potential_scale: 3.0
    
    # Orientation scale: Weight for maintaining current orientation
    # Higher = prefer frontiers that don't require much rotation
    # Set to 0 for mecanum drive (can move sideways, rotation not costly)
    orientation_scale: 0.0
    
    # Gain scale: Weight for information gain
    # Higher = prefer frontiers that reveal more unknown area
    # Lower = care more about travel cost
    gain_scale: 1.0
    
    # =====================================================================
    # FRONTIER DETECTION
    # =====================================================================
    
    # Minimum frontier size: Smallest frontier to consider (meters)
    # Smaller frontiers are likely noise or dead ends
    # Larger values speed up planning but may miss small unexplored areas
    min_frontier_size: 0.75
    
    # =====================================================================
    # TRANSFORM HANDLING
    # =====================================================================
    
    # Transform tolerance: How much delay acceptable in transform data (seconds)
    # Larger values tolerate more timing jitter but may use stale data
    transform_tolerance: 0.3
    
    # =====================================================================
    # GOAL MANAGEMENT
    # =====================================================================
    
    # Goal tolerance: How close robot must get to exploration goal (meters)
    # Smaller = more precise but may get stuck
    # Larger = more forgiving but may not explore thoroughly
    goal_tolerance: 0.3
    
    # =====================================================================
    # RECOVERY BEHAVIOR
    # =====================================================================
    
    # Retry count: How many times to retry if goal fails
    # Helps handle temporary obstacles or planning failures
    retry_count: 3
    
    # Blacklist timeout: How long to avoid a failed frontier (seconds)
    # After timeout, failed frontiers can be reconsidered
    blacklist_timeout: 60.0
    
    # =====================================================================
    # ADVANCED PARAMETERS
    # =====================================================================
    
    # Search for frontiers in a specific region (optional)
    # Set to empty for full map exploration
    # Format: [min_x, min_y, max_x, max_y]
    # Example: search_region: [-5.0, -5.0, 5.0, 5.0]
    search_region: []
    
    # Use boundary exploration: Stay near known areas (true/false)
    # True = explore edges of known space first
    # False = can explore anywhere
    boundary_exploration: false
    
    # =====================================================================
    # PERFORMANCE TUNING
    # =====================================================================
    
    # Enable multithreading for frontier detection
    # Speeds up planning on multi-core processors like RPi 5
    multithreading: true
    
    # Number of threads (0 = auto-detect)
    # RPi 5 has 4 cores, so up to 4 threads beneficial
    num_threads: 4
    
    # =====================================================================
    # MAZE-SPECIFIC TUNING
    # =====================================================================
    # These values are optimized for 3x3m maze exploration
    
    # For smaller mazes, you might want:
    # - Lower planner_frequency (0.33 Hz) - less frequent re-planning
    # - Smaller min_frontier_size (0.5m) - catch smaller unexplored areas
    # - Higher gain_scale (1.5) - prioritize coverage over travel cost
    
    # For larger mazes, you might want:
    # - Higher planner_frequency (1.0 Hz) - more responsive
    # - Larger min_frontier_size (1.0m) - ignore tiny gaps
    # - Lower gain_scale (0.8) - prioritize efficiency
    
    # =====================================================================
    # DEBUGGING
    # =====================================================================
    
    # Enable detailed logging (true/false)
    # Useful for troubleshooting but creates large log files
    debug_logging: false
    
    # Publish frontier markers for visualization
    # These appear in RViz on /explore/frontiers topic
    publish_frontiers: true
    
    # =====================================================================
    # INTEGRATION WITH CUSTOM NODES
    # =====================================================================
    
    # M-Explore works with:
    # - start_end_detector.py: Waypoint detector monitors exploration progress
    # - completion_led.py: LED blinks when m-explore finds no more frontiers
    # - slam_toolbox: Provides the map that m-explore analyzes
    # - nav2: Executes the navigation goals that m-explore generates
    
    # No direct configuration needed here - integration is automatic via topics

